# RSS3 Protocol v0.4.0-rc.1 （RSS3 协议 v0.4.0-rc.1）

## 1. Abstract （摘要）

The right to create, disseminate and distribute information should not be in the hands of centralized governing. It is the basic right of cyber lives.

对网络公民来说，制作、公开和传播信息这一项基本权利，不应落入中心化监管之手。

Gradually over the past two decades, several data superpowers have controlled contents and links to create a toxic centralized atmosphere, where privacy and freedom are sacrificed for profits. This atmosphere further hinders innovations: No matter how well you design and engineer your application, there is no way to compete with the data monopolies.

过去二十年，若干数据霸主利用对内容和链接的控制造成了中心化的有害局面，使得隐私和自由不得不让步于利益。这一局面进一步抑制了创新：无论你如何完美地设计和制作你的作品，却始终无法在与数据寡头的竞争中获胜。

The world has been eager for a new way of information syndication. RSS used to be the pioneer of its time, now it’s time for us to pick up the baton and carry on.

世界正渴求着一种新型的信息组织形式。RSS 曾是它所在时代信息流转的先锋。现在，该我们拾起接力棒继续前行。

Derived from the best out of RSS, RSS3 is an open information syndication protocol that aims to support efficient and decentralized information distribution in Web3.

取 RSS 之精华而成的 RSS3 是一个开放的信息组织分发协议，致力于在 Web3 中高效和去中心化地传播信息。

This document defines the aggregation format and communication of information for cryptographically based decentralized accounts.

本文档定义了加密技术体系下去中心化账户间的聚合格式和信息交互办法。

## 2. Status of This Document （关于本文档现状的说明）

This version is a beta version, although this protocol is well established in theory, it still needs to be tested in practice, so it is not guaranteed to be compatible with subsequent versions, but breaking updates will be kept to a minimum.

虽然理论上本协议已完备，但该版本仍处于测试阶段，需要在实际应用中检验。因此，团队无法保证本文档与后续版本相互兼容，但会尽量在后续更新中保持连贯性。

## 3. Dependencies （依赖）

- [RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax](https://datatracker.ietf.org/doc/html/rfc3986): The protocol uses a large number of RFC 3986 Uniform Resource Identifiers to identify things in RSS3. （[RFC 3986 - 统一资源标识符 (URI): 一般语法](https://datatracker.ietf.org/doc/html/rfc3986): 本协议使用了大量 RFC 3986 统一资源标识符来标识 RSS3 中的事项。）
- [RFC 6838 - Media Type Specifications and Registration Procedures](https://datatracker.ietf.org/doc/html/rfc6838): The value of the item.attachment.mime_type field in the protocol uses the RFC 6838 standard. （[RFC 6838 - 媒体类别规范和登记程序](https://datatracker.ietf.org/doc/html/rfc6838): 协议中 item.attachment.mime_type 域的赋值采用 RFC 6838 标准。）
- [JSON Schema: A Media Type for Describing JSON Documents](https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-00): The protocol provides the user with a series of JSON Schema to do format validation. （[JSON Schema: 一种描述 JSON 文档的媒体类别](https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-00): 本协议为用户提供一系列 JSON Schema 以进行格式验证。）
- [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601): All times appearing in the protocol use the extended ISO 8601 format with 3 decimals (YYYY-MM-DDTHH:mm:ss.sssZ).  （[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601): 本协议中出现的所有时间表述均使用三位小数形式的 ISO 8601 日期扩展格式。）

## 4. Main Concepts （主要概念）

### 4.1. File （文件）

The RSS3 Network returns data and the user submits data in the form of RSS3-compliant JSON files. There are two types of files, Index File and their attached List File, of which you can get an overview by browsing through the [Use Cases](#_6-use-cases).

用户提交的数据将是适配 RSS3 的 JSON 文件， RSS3 网络则会返回数据。 文件分为索引文件及其附属的列表文件。可在[用例](#_6-use-cases)处浏览文件的全貌。

The mime_type of RSS3 file is `application/rss3+json`, it is recommended to include `content-type: application/rss3+json; charset=utf-8` in the Response Headers of RSS3 file.

RSS3 文件的 mime 类型是 `application/rss3+json`。 建议在 RSS3 文件的响应头中包含 `content-type: application/rss3+json; charset=utf-8`。

#### 4.1.1. File Base （基础文件）

Each file has some basic properties.

每个文件具有一些基本属性。

```ts
type FileBase = {
    version: 'v0.4.0';
    identifier: InstanceURI | CustomItemListURI | AggregatedItemListURI | CustomLinkListURI | AggregatedLinkListURI | BacklinkListURI;
    date_created: string;
    date_updated: string;
} & (SignedBase | UnsignedBase);
```

##### 4.1.1.1. `version`

Version of the protocol, the current is `v0.4.0`.

协议版本，当前版本是 `v0.4.0`。

##### 4.1.1.2. `identifier`

The URI of the current file, which should also contain the query if there is one.

当前文件的 URI （统一资源标识符）：若是在查询场景下需包含查询。

##### 4.1.1.3. `date_created` and `date_updated` （`date_created` 和 `date_updated`）

The creation time and update time of the file, in the format of extended ISO 8601 with 3 decimals (YYYY-MM-DDTHH:mm:ss.sssZ).

文件创建或更新时的时间戳：使用三位小数形式的 ISO 8601 日期扩展格式。

##### 4.1.1.4. SignedBase and UnsignedBase （SignedBase 和 UnsignedBase）

See [Authentication](#_4-8-authentication).

详见[授权](#_4-8-authentication)。

#### 4.1.2. Index File （索引文件）

The Index file is the main entry point for the instance and holds general information about the instance, including the details of [profile](#_4-7-profile) and URIs of the [links](#_4-6-link) or [items](#_4-5-item) list, etc.

索引文件时实体的主要切入点，其掌握着实体的一般性信息，包括[个人资料](#_4-7-profile)的细节、[链接](#_4-6-link)的 URI 或者[条目](#_4-5-item)列表等。

```ts
type IndexFile = FileBase & {
    profile?: Profile;
    links: LinksSet;
    items: ItemsSet;
}
```

##### 4.1.2.1. `profile` and `links` and `items` (`profile` 和 `links` 和 `items`)

- [Profile](#_4-7-profile) （[个人资料](#_4-7-profile)）
- [Link](#_4-6-link) （[链接](#_4-6-link)）
- [Item](#_4-5-item) （[条目](#_4-5-item)）

#### 4.1.3. List File （列表文件）

The list file is used to store the list data, including various item lists and link lists.

列表文件用于存储列表数据，包括各种条目列表和链接列表。

| Type （种类） | Signed （是否签名） | URI | List Element （列表元素） |
| --- | --- | --- | --- |
| Custom Item List （可定制条目列表） | true （真） | `CustomItemListURI` | `Item` |
| Aggregated Item List （聚合条目列表） | false （假） | `AggregatedItemListURI` | `Item` |
| Custom Link List （可定制链接列表） | true or false （真 或 假） | `CustomLinkListURI` | `InstanceURI` |
| Aggregated Link List （聚合链接列表） | false （假） | `AggregatedLinkListURI` | `InstanceURI` |
| Backlink List （反向链接列表） | false （假） | `BacklinkListURI` | `InstanceURI` |

```ts
type ListFile<URIType, ElementType> = FileBase & {
    identifier: URIType;
    identifier_next?: URIType;

    total: number;
    list?: ElementType[];
}

// for items
type CustomItemList = SignedBase & ListBase<CustomItemListURI, Item>;
type AggregatedItemList = UnsignedBase & ListBase<AggregatedItemListURI, Item>;

// for links
type CustomLinkList = (SignedBase | UnsignedBase) & ListBase<CustomLinkListURI, InstanceURI>;
type AggregatedLinkList = UnsignedBase & ListBase<AggregatedLinkListURI, InstanceURI>;
type BacklinkList = UnsignedBase & ListBase<BacklinkListURI, InstanceURI>;
```

##### 4.1.3.1. `list`

List element, depending on the type of the list file, may be item, link, backlink, etc.

列表元素，可以时条目、链接、反向链接等，由列表文件的种类决定。

##### 4.1.3.2. `identifier_next`

The URI used to identify the next page. If not specified, the current page is the last one by default.

标识下一页的 URI。 若未指定，默认当前页是最后一页。

For example:

例如：

```json
{
    "identifier":      "rss3://account:0xtest@ethereum/list/note/1",
    "identifier_next": "rss3://account:0xtest@ethereum/list/note/0"
}
{
    "identifier":      "rss3://account:0xtest@ethereum/list/note?limit=5",
    "identifier_next": "rss3://account:0xtest@ethereum/list/note?limit=5&last_time=2022-01-01T00:00:00Z"
}
```

##### 4.1.3.3. `total`

Total number of elements in this page and its next pages.

当前页和下一页的元素的总数。

### 4.2. Account （账户）

In order to remain open and compatible, the protocol does not create a new account system. Instead, it is compatible with existing account systems of other platforms, including accounts of cryptography-based decentralized and centralized platforms.

为了保持开放和兼容，本协议不会创建一个新的账户系统。本协议兼容现存各个平台的账户系统，包括加密技术体系下非中心化的平台和中心化平台。

There are two types of accounts

有两种账户

- Main Account: the account in the instance URI, which represents the owner and signer of the file and can only be of a decentralized platform. （主账户：实体 URI 中的账户，代表拥有者和文件签名人，且必须来自非中心化平台。）

- Connected Accounts: accounts in the `profile.account` field, which represents other accounts belonging to the instance. （连接的账户：`profile.account` 域中的账户，代表属于实体的其它账户。）

An account consists of two pieces of information: the account ID and the platform to which the account belongs.

一个账户包含两份信息：账户 ID 和账户所属的平台。

```xsl
Account = <identity>@<account_platform>
```

- `identity` is the unique account ID within the platform; （`identity` 是平台中的唯一账户 ID；）
- `account_platform` is defined by [RIP-1: Registered Account Platforms](./RIPs/RIP-1.md). （`account_platform` 由 [RSS3 改进提案-1: 在册用户平台](./RIPs/RIP-1.md) 定义。）

For example,

例如，

- An Ethereum account can be represented as `0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`. （一个以太坊账户表示为 `0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`。）

- A Twitter account can be represented as `DIYgod@twitter`. （一个 Twitter 账户表示为 `DIYgod@twitter`。）

### 4.3. Instance （实体）

An instance is an RSS3 interactive object, an RSS3 presence unit that contains an RSS3 Index file and its attached list files.

一个实体是一个 RSS3 交互型物件，即包含一个 RSS3 索引文件和其附属列表文件的 RSS3 显性单元。

```xsl
Instance = <prefix>:<identity>@<platform>
```

- `prefix` is one constant of `account`, `asset`, `note`; （`prefix` 是 `account`, `asset`, `note` 的一个定值。）
- `platform` is the platform to which the instance belongs. The platform of account is defined by [RIP-1: Registered Account Platforms](./RIPs/RIP-1.md), and the platform of item is defined by [RIP-3: Registered Item Networks](./RIPs/RIP-3.md) and [RIP-4: Registered Indexed Items](./RIPs/RIP-4.md); （`platform` 是实体所属的平台。账户的平台由[RSS3 改进提案-1: 在册用户平台](./RIPs/RIP-1.md)定义。条目的平台由[RSS3 改进提案-3: 在册条目网络](./RIPs/RIP-3.md) and [RSS3 改进提案-4: 在册索引条目](./RIPs/RIP-4.md)定义；）
- `identity` is the unique ID of the instance on this platform. （`identity` 是该实体在平台上的唯一 ID。）

#### 4.3.1. Account Instance （账户实体）

An Account Instance is an Instance created with an account.

一个账户实体是指由一个账户创建的一个实体。

```xsl
AccountInstance = account:<account_identity>@<account_platform>
```

For example,

例如，

- `account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`
- `account:DIYgod@twitter`

#### 4.3.2. Item Instance （条目实体）

Before continuing, you may need to learn about [Item Types](#_4-5-1-item-types).

在继续前，你可能需要事先了解一下[条目种类](#_4-5-1-item-types)。

An Item Instance is an Instance for Item.

一个条目实体是指为条目构造的实体。

```xsl
ItemInstance = CustomItemInstance | IndexedItemInstance

IndexedItemInstance = {asset|note}:<metadata_proof>@<item_network>
CustomItemInstance  = {asset|note}:<account_platform>-<account_identity>-<item_date_created_timestamp>@rss3
```

::: warning
`date_created` is used to compose the unique ID, which means that no items with the same `date_created` can exist under the same Account Instance.
:::

::: 警告
唯一 ID 一般由 `date_created` 构成，这表示在一个账户实体下不会存在相同 `date_created` 的两个条目。

For example,

例如，

- `asset:0xacbe98efe2d4d103e221e04c76d7c55db15c8e89-5@ethereum`
- `note:ethereum-0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944-1647280857187@rss3`

### 4.4. Identifier （标识符）

The protocol uses a number of Uniform Resource Identifiers (URIs) that conform to the [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) standard to identify things in RSS3, such as instance identifiers, item identifiers, and list identifiers. The RSS3 URI can be used by users to access the items it represents or as the target of a link.

本协议使用一组基于 [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) 标准的统一资源标识符（URI）来标识 RSS3 中的事项，诸如实体标识符、条目标识符和列表标识符。 用户可以使用 RSS3 URI 来获取其所标识的条目或一个链接所指向的目标。

#### 4.4.1. Scheme （模式）

The scheme is `rss3`. I.e. RSS3 URI starts with `rss3://`.

模式是 `rss3`。即，RSS3 URI 由 `rss3://` 开头。

#### 4.4.2. Authority （主体）

The protocol uses [Instance](#_4-3-instance) as an authority.

本协议使用[实体](#_4-3-instance)作为主体。

#### 4.4.3. URI

The below illustrates the component of each URI.

以下展示了每个 URI 的组成部分。

##### 4.4.3.1. Instance URI （实体的 URI）

```xsl
InstanceURI = AccountInstanceURI | ItemInstanceURI

AccountInstanceURI = rss3://<AccountInstance>
ItemInstanceURI = rss3://<ItemInstance>
```

E.g.

- Account Instance URI （账户实体的 URI）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum
    ```

- Asset Instance URI （资产实体的 URI）

    ```text
    rss3://asset:0xb9619cf4f875cdf0e3ce48b28a1c725bc4f6c0fb-1024@ethereum
    ```

- Note Instance URI （注记实体的 URI）

    ```text
    rss3://note:1483972580616949762@twitter
    ```

##### 4.4.3.2. Item List URI （条目列表的 URI）

```xsl
CustomItemListURI     = rss3://<Instance>/list/{note|asset}/<page_index>
AggregatedItemListURI = rss3://<Instance>/list/{note|asset}[?<query_string>]
```

If `page_index` exists, then the list is Custom Item list and uses it for pagination. The starting index `page_index` is `0`.

若存在 `page_index`，则该列表是用于页面导航的可定制条目列表。起始索引  `page_index` 是 `0`。

If `page_index` does not exist, then the list is an aggregated item list, which may include both Custom Items and Indexed Items.

若不存在 `page_index`，则该列表是一个聚合条目列表，可同时包含可定制条目和被索引条目。

> Please refer to [Item](#_4-5-item) to know more.

> 请至[条目](#_4-5-item)了解更多。

Available queries:

可用查询：

| Key （键值） | Usage （用法） |
| --- | --- |
| limit | Used for pagination, limiting the count of the returning items. There should be a maximum and minimal value when implementing. （在页面导航中用于限制返回条目的数量。在执行时应指定最大和最小值。） |
| last_time | Used for pagination. An ISO 8601 time. If specified, returning only items before this time. （用于页面导航。应是基于 ISO 8601 标准的时间值。若指定，则仅返回该时间之前的条目。） |
| link_type | If specified, returning only the corresponding link type of items. （若指定，则仅返回相应链接种类的条目。） |
| filter_tags | If specified, returning only items of the corresponding tags (filtered using the `tags` attribute of items). Multiple values are separated by commas. （若指定，则仅返回相应标签的条目（利用条目属性 `tags` 进行过滤）。多个值用逗号分隔。） |
| filter_auto | If true, returning only items with `auto` field set to true. If false, the opposite. If not available, no filter on this effect will be applied. （若为真，则仅返回 `auto` 域设定为真的条目。若为假，则相反。若不可用，不会应用该类过滤器。 ） |
| filter_network | If specified, returning only items with `metadata.network` field in the filter list. Multiple values are separated by commas. （若指定，则仅返回过滤器列表中标记有 `metadata.network` 域的条目。多个值用逗号分隔。） |
| filter_mime_types | If specified, returning only items with `attachments.mime_type` field containing the corresponding values. Multiple values are separated by commas. （若指定，则仅返回 `attachments.mime_type` 域符合相应指定值的条目。多个值用逗号分隔。） |

E.g.,

- The custom note list in the second list page: （第二个列表页中的可定制注记列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/1
    ```

- The list of the first 5 notes: （前 5 个注记的列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note?limit=5
    ```

- The note list from the instance's following instances: （该实体关注的实体们的注记列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note?link_type=following
    ```

##### 4.4.3.3. Link List URI （链接列表的 URI）

```xsl
CustomLinkListURI     = rss3://<Instance>/list/link/<link_type>/<page_index>
AggregatedLinkListURI = rss3://<Instance>/list/link/<link_type>[?<query_string>]
```

`link_type` is defined by [RIP-5: Registered Link Types](./RIPs/RIP-5.md).

`link_type` 由[RSS3 改进提案-5: 在册链接类别](./RIPs/RIP-5.md)定义。

Available queries:

可用查询：

| Key （键值） | Usage （用法） |
| --- | --- |
| limit | Used for pagination, limiting the count of the returning items. There should be a maximum and minimal value when implementing. （在页面导航中用于限制返回条目的数量。在执行时应指定最大和最小值。） |
| last_instance | Used for pagination. If specified, returning the instances after this instance. （用于页面导航。若指定，则仅返回该实体之后的实体。） |
| instance | If specified, returning only the list containing this instance. If specified but no list satisfies, returning null. （若指定，则仅返回含有该实体的列表。若指定实体后没有列表满足条件，则返回空。）|

E.g.

- The following link list in the second list page: （第二个列表页中的关注链接列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1
    ```

- The following link list of the first 5 instances: （前 5 个实体中的关注链接列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following?limit=5
    ```

- Query if an instance is followed by another instance: （查询是否一个实体被另一个实体关注：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following?instance=0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944
    ```

##### 4.4.3.4. Backlink List URI （反向链接列表的 URI）

```xsl
BacklinkListURI = rss3://<Instance>/list/backlink[?<query_string>]
```

Available queries: 

可用查询：

| Key （键值） | Usage （用法） |
| --- | --- |
| type | Returning only backlinks of this type. （仅返回该种类的反向链接。） |
| limit | Used for pagination, limiting the count of the returning items. There should be a maximum and minimal value when implementing. |
| last_instance | Used for pagination. If specified, returning the instances after this instance. （在页面导航中用于限制返回条目的数量。在执行时应指定最大和最小值。） |
| instance | If specified, returning only the list containing this instance. If specified but no list satisfies, returning null. （若指定，则仅返回含有该实体的列表。若指定实体后没有列表满足条件，则返回空。） |

E.g.

- The following list of the first 5 instances: （前 5 个实体的关注列表：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/backlink?type=following&limit=5
    ```

- Query if an instance is following another instance: （查询一个实体是否关注另一个实体：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/backlink?type=following&instance=0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944
    ```

- A note’s comments: （一个注记的评论：）

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/notes/5591079b-1f5b-4ae9-8209-51b18f0d3be0/list/backlink/comment
    ```

### 4.5. Item （条目）

Item is an action or good that is automatically or passively generated by an instance. The protocol cannot predict what types of content there will be, so the protocol strives to define it more generically and unrestricted. It may be a blog post, an NFT, or a commodity, a game activity, etc.

条目是一个由实体自动或被动生成的动作或物资。协议不能预测其内容是什么种类，所以协议力求将其定义得宽泛而不受限。条目可以是一篇博客日志，一个 NFT，或一个商品，一个游戏活动，等等。

#### 4.5.1. Item Types （条目种类）

##### 4.5.1.1. According to source （根据条目来源）

- Indexed Items: Items automatically indexed by the RSS3 Network from other networks or platforms based on the Main Account and Connected Accounts, as defined in [RIP-4: Registered Indexed Items](./RIPs/RIP-4.md). （被索引的条目：由[RSS3 改进提案-4: 在册索引条目](./RIPs/RIP-4.md)所定义，基于主账户和连接账户，被 RSS3 网络从其它网络或平台自动索引的条目。）

- Custom Items: Items signed and submitted by user themselves. （可定制条目：由用户自己签名或提交的条目。）

##### 4.5.1.1. According to content （根据条目内容）

- Assets: They are the assets owned by instances, which can also be extended and interpreted as any fixed display content according to different usage scenarios, such as an NFT, a game achievement, a physical figure, a commodity for sale, etc. （资产：由实体所拥有的资产，可根据不同的使用场景扩展或理解为任意一种固定的展示内容，比如一个 NFT、一个游戏成就、一个物理实体，一个待售商品，等等。）

- Notes: They are the actions or events generated by the instance, which can also be extended and interpreted as any stream content according to different usage scenarios, such as writing a blog post, getting a NFT dynamic, writing a forum post, posting a reply to other items, etc. （注记：由实体生成的动作或事件，并可以根据不同的使用场景扩展或理解为任意一种信息流内容，比如获得 NFT 的动态，撰写一份论坛日志，发表对其它条目的回复，等等。）

#### 4.5.2. Item Overall （条目总体情况）

The structure of Items could be seen in an index file:

在索引文件中可以看到条目的结构：

```ts
type ItemsSet = {
    notes: {
        identifier_custom?: CustomItemListURI;
        identifier: AggregatedItemListURI;
        filters?: Filters;
    };
    assets: {
        identifier_custom?: CustomItemListURI;
        identifier: AggregatedItemListURI;
        filters?: Filters;
    };
};
```

##### 4.5.2.1. `items.assets`

`assets` are the items owned by instances, which can also be extended and interpreted as any fixed display content according to different usage scenarios, such as an NFT, a game achievement, a physical figure, a commodity for sale, etc.

`assets` 是实体所拥有的条目，可根据不同的使用场景扩展或理解为任意一种固定的展示内容，比如一个 NFT、一个游戏成就、一个物理实体，一个待售商品，等等。

##### 4.5.2.2. `items.notes`

`notes` are the actions or events generated by the instance, which can also be extended and interpreted as any stream content according to different usage scenarios, such as writing a blog post, getting a NFT dynamic, writing a forum post, posting a reply to other items, etc.

`notes` 是由实体生成的动作或事件，并可以根据不同的使用场景扩展或理解为任意一种信息流内容，比如获得 NFT 的动态，撰写一份论坛日志，发表对其它条目的回复，等等。

##### 4.5.2.3. `items.x.identifier_custom`

`identifier_custom` records the URI of the Custom Item list on the last page, and the list element is the item submitted by the user himself.

`identifier_custom` 记录最后一页上的可定制条目列表的 URI，列表元素为用户自己提交的条目。

When there is only one page of content, the value of `identifier_custom` is `rss3://<Instance>/list/{note|asset}/0` till the content exceeds the file size limit specified by the RSS3 Network. Then the new item is recorded in a new file whose URI is `rss3://<Instance>/list/{note|asset}/1`, and the `identifier_custom` field is changed to `rss3://<Instance>/list/{note|asset}/1`.

当只有一页内容时， `identifier_custom` 的值为 `rss3://<Instance>/list/{note|asset}/0` ，直到内容超过了 RSS3 网络设定的文件大小限制。 然后新条目将在一个 URI 为 `rss3://<Instance>/list/{note|asset}/1` 的新文件中记录，且 `identifier_custom` 域变更为 `rss3://<Instance>/list/{note|asset}/1`。

##### 4.5.2.4. `items.x.identifier`

`identifier` is the URI of the aggregated item list, which contains both Custom Items and Indexed Items, sorted by `date_created`, the newest at the top. It supports some queries.

`identifier` 是包含可定制条目和被索引条目的聚合条目列表的 URI，按 `date_created` 排序，最新的条目位于顶部。其支持若干查询。

##### 4.5.2.5. `items.x.filters`

`filters` are used to filter the **Index Items** returned by `identifier` to meet the needs of the user's selective display.

`filters` 用于过滤由 `identifier` 返回的**索引条目**，以满足用户选择性显示的需求。

It filters on `item.tags` and `item.metadata.network`.

它可以过滤 `item.tags` 和 `item.metadata.network` 两个域。

```ts
type Filters = {
    blocklist?: string[];
    allowlist?: string[];
}
```

###### 4.5.2.5.1. `items.x.filters.blocklist`

Prevent items or backlinks containing fields in this list from being returned, e.g. `blocklist: ["twitter"]`, in which case, items with `item.tags` and `item.metadata.network` value of `twitter` will not be returned by AggregatedItemListURI.

含有该列表中指定值的条目或反向链接将不被返回，例如，`blocklist: ["twitter"]` 的情景下，`item.tags` 和 `item.metadata.network` 两个域中含有 `twitter` 的条目不会被 AggregatedItemListURI 返回。

###### 4.5.2.5.2. `items.x.filters.allowlist`

Only items or backlinks that contain fields in this list are allowed to be returned. If there is an allowlist, the blocklist will be invalid. For example, if `allowlist: ["twitter"]`, then only items with `item.tags` and `item.metadata.network` value of `twitter` will be returned by AggregatedItemListURI.

仅返回含有该列表中指定值的条目或反向链接，例如，`allowlist: ["twitter"]` 的情景下，只有 `item.tags` 和 `item.metadata.network` 两个域中含有 `twitter` 的条目会被 AggregatedItemListURI 返回。

#### 4.5.3. Item Details （条目细节）

```ts
type Item = {
    identifier: ItemInstanceURI;
    date_created: string;
    date_updated: string;

    auto?: true;
    related_urls?: string[];

    links: LinksSet;

    tags?: string[];
    authors: Account[];
    title?: string;
    summary?: string;
    attachments?: Attachment[];

    metadata?: {
        network: NetworkName;
        proof: string;

        [key: string]?: any;
    };
};
```

##### 4.5.3.1. `item.date_created`

The time when the action or item was generated, in the format of ISO 8601, such as the time when the article was published, the time when the NFT was mint, the time when the product was put on the shelf, the time when the NFT was obtained (in the note, it indicates the time when the action was generated), etc.

基于 ISO 8601 标准的动作或条目生成的时间，例如文章发布的时间、 NFT 铸造的时间、产品上架的时间、NFT 获得的时间（在注记中，其指示动作生成的时间），等等。

##### 4.5.3.2. `item.date_updated`

The time of an action or item change, in the format of ISO 8601, such as article modification time, acquisition time of NFT (in the asset, indicating the time of the item change), etc.

基于 ISO 8601 标准的动作或条目更新的时间，例如文章更新的时间，NFT 获取的时间（在资产中，其指示条目变更的时间），等等。

##### 4.5.3.3. `item.auto`

If true, it means this is a Indexed Item rather than an Custom Item.

若为真，则表示其为一个被索引的条目，而非一个可定制的条目。

##### 4.5.3.4. `item.related_urls`

Only for Custom Items. URLs associated with the item, such as the address of the item in the indexed network.

仅可定制的条目具有该域，应含有条目有关的链接，例如在被索引网络中的条目的地址。

##### 4.5.3.5. `item.identifier`

`identifier` is the uri of the item. See [Instance URI](#_4-4-3-1-instance-uri).

`identifier` 是条目的 URI。 间 [实体 URI](#_4-4-3-1-instance-uri)。

##### 4.5.3.6. `item.links`

See [Link](#_4-6-link).

见 [Link](#_4-6-link)。

##### 4.5.3.7. `item.tags`

`tags` is an array of strings. Similar to the concept of tags commonly used in personal blogs, you can add multiple tags to an article; the Indexed Items will also have tags, indicating the type of the item, and the specific value is limited in [RIP-4: Registered Indexed Items](./RIPs/RIP-4.md).

`tags` 是一组字串。就像博客中常用的标签概念一样，你可以给一篇文章增加多个标签。被索引的条目也有标签，用来指示条目的种类，可指定的值由[RSS3 改进提案-4: 在册索引条目](./RIPs/RIP-4.md)所限。

##### 4.5.3.8. `item.authors`

`authors` is an array of Accounts, indicating the accounts who have produced this item, such as the author of the article, the seller of the product, etc. It can be omitted if it is the current instance address.

`authors` 是一组账户名，指示产出该条目的账户，例如文章的作者、产品的卖家，等等。若当前实体地址即为作者，该域可忽略。

If the item is an Indexed Item and the author is a Connected Account, it will additionally contain the Main Account.

若条目是一个被索引条目且作者是一个连接账户，那该域将额外包含主账户。

##### 4.5.3.9. `item.title` and `item.summary` （`item.title` 和 `item.summary`）

The content of a `summary` cannot be too long, and the RSS3 Network should set a maximum length.

`summary` 的内容不能太长。 RSS3 网络应该设置一个最大长度。

If it is a short content, then it is likely to only have a `summary` without a `title`, such as a Tweet from Twitter.

对短内容而言，其有可能只含有没有 `title` 的 `summary`，例如来自 Twitter 的推文。

If it is a long article and its word count exceeds the size limit, then its `summary` should only be a summary or truncation of the article, and the complete content should be placed in `attachments`.

对字数超过长度限制的长文章而言，其 `summary` 只能是一个概要或长文章的片段，完整内容应放置于 `attachments`。

##### 4.5.3.10. `item.attachments`

`attachments` records the attachments of this item, such as images of the article, etc. If it is a long article, it may also contain the full text of the article.

`attachments` 记录了条目的附件，例如文章的图片，等等。若条目是长文章，则该域可以含有该文章的全文。

It is an array of attachment. Each element's structure is:

该域是一组附件，每个元素的结构如下：

```ts
type Attachment = {
    type?: string;
    content?: string;
    address?: URI;
    mime_type: string;
    size_in_bytes?: number;
}
```

###### 4.5.3.10.1. `item.attachments[i].type`

The type of attachment, indicating the function or classification of this attachment, such as thumbnail, detailed description, etc.

附件的种类，用于指示该附件的功用或类别，例如缩略图、详细描述，等等。

This value can be any string.

该值可以是任意字符串。

###### 4.5.3.10.2. `item.attachments[i].content` and `item.attachments[i].address` （`item.attachments[i].content` 和 `item.attachments[i].address`）

`content` is the actual content of the attachment, such as the full body of the article or the base64 string of an image. The content of this field may be very long, but the RSS3 Network should also be limited to the maximum length of the content to avoid affecting the storage efficiency of the entire network. Content that exceeds the maximum length limit should be placed in the address field using third-party storage.

`content` 是附件的具体内容，例如文章整体或一幅图片的 base64 字符串。出于保护整个网络，避免影响存储效率的目的，即使该内容可以非常长，但 RSS3 网络仍会限定该内容的最大长度。超过最大长度限制的内容需要使用第三方空间存储于地址域。

`address` is the URI of this attachment pointing to a third-party address, such as a markdown file address or an image address.

`address` 是该附件指向第三方地址的 URI，例如一个 markdown 文件地址或一个图片地址。

`content` and `address` are mutually exclusive, one attachment can only have one and only one of them.

`content` 和 `address` 不可兼有。一个附件有且仅有二者之一。

###### 4.5.3.10.3. `item.attachments[i].mime_type`

This records the media type of this attachment. The format must conform to the RFC 6838 standard, such as `image/png`, `text/markdown`, etc. This is an important but easily overlooked field from an application presentation point of view, so the protocol specifies it as a required field.

该域记录附件的媒体种类。其值需要符合 RFC 6838 标准，例如 `image/png`、 `text/markdown` 等等。从应用表达的实用角度出发，这是一个重要但易被忽视的域，所以协议将其指定为必须包含。

###### 4.5.3.10.4. `item.attachments[i].size_in_bytes`

This records the size of this attachment in bytes. It is useful for displaying large files such as videos and audios. It is also a field that is easily overlooked. The protocol recommends that the existence and accuracy of this field be ensured as much as possible.

该域用字节数记录附件的大小，对于显示视频和音频等大文件十分有用。同时该域也易被忽略，因此协议建议尽可能确保该值存在且正确。

##### 4.5.3.11. `item.metadata`

This records metadata for Indexed Items, with specific values defined in [RIP-4: Registered Indexed Items](./RIPs/RIP-4.md).

该域用[RSS3 改进提案-4: 在册索引条目](./RIPs/RIP-4.md)中指定的值记录被索引条目的元数据。

###### 4.5.3.11.1. `item.metadata.network`

The network where this item is stored.

储存该条目的网络。

Its value is defined by [RIP-3: Registered Item Networks](./RIPs/RIP-3.md).

其值由[RSS3 改进提案-3: 在册条目网络](./RIPs/RIP-4.md)定义。

###### 4.5.3.11.2. `item.metadata.proof`

This records the credentials for indexing this Indexed Item, such as transaction hash and the address of a centralized platform.

该域记录索引该被索引条目的证书，例如交互哈希和中心化平台的地址。

### 4.6. Link （链接）

This describes the relationship between two instances or items in RSS3.

其描述了 RSS3 中两个实体或条目间的关系。

#### 4.6.1. Item Types （条目类别）

- Indexed Links: Links automatically indexed by the RSS3 Network from other networks or platforms based on the Main Account and Connected Accounts. （被索引链接：基于主账户或连接账户，被 RSS3 网络自动从其它网络或平台索引的链接。）

- Custom Links: Links signed and submitted by user themselves or automatically indexed by the Index Item Instance. （可定制链接：由用户自己签名或提交的链接，或者由索引条目实体自动索引的链接。）

#### 4.6.2. Link Overall （链接总体）

Link exists in two places, Instance and Item, both of which have a `links` field. In the content:

链接域存在于实体和条目中，两者皆包含 `links` 域。内容如下：

```ts
interface LinksSet {
    identifiers?: {
        type: LinkType;
        identifier_custom: CustomLinkListURI;
        identifier: AggregatedLinkListURI;
    }[];
    identifier_back: BacklinkListURI;
}
```

##### 4.6.2.1. `links.identifiers.type`

The type of relationship, such as the following relationship of Instance, the comment relationship of Item, etc. The specific value is restricted in [RIP-5: Registered Link Types](./RIPs/RIP-5.md).

关系类别，例如实体的关注关系、条目的评论关系，等等。其值由[RSS3 改进提案-5: 在册链接类别](./RIPs/RIP-5.md)限定。

##### 4.6.2.2. `links.identifiers.identifier_custom`

This records the URI of the Custom Link list on the last page.

该域记录在最后一页中可定制链接列表的 URI。

When there is only one page of content, the value of `identifier_custom` is `rss3://<Instance>/list/link/0`, until the content exceeds the file size limit specified by the RSS3 Network, then the new link is recorded in a new file whose URI is `rss3://<Instance>/list/link/1`, and changes the `identifier_custom` field to `rss3://<Instance>/list/link/1`.

当只有一页内容时，`identifier_custom` 的值为 `rss3://<Instance>/list/link/0` ；直至内容超出了 RSS3 网络所限定的文件大小时，新链接将由 URI 为 `rss3://<Instance>/list/link/1` 的新文件记录，并且 `identifier_custom` 域变更为 `rss3://<Instance>/list/link/1` 。

##### 4.6.2.3. `links.identifiers.identifier`

This is the URI of the aggregated link list, which supports some queries.

该域是聚合链接列表的 URI，其支持若干查询。

##### 4.6.2.4. `links.identifier_back`

This records the reverse relationship of this link. For example, if A records a following relationship to B, then the `identifier_back` of B will automatically record a reverse-following (i.e., followed-by) relationship of A.

该域记录该链接的反向关系。例如，若 A 记录了一个关注 B 的关系，那么 B 的 `identifier_back` 将自动记录一个 A 的反向关注 （即，被关注）关系。

#### 4.6.2. Link Details （链接细节）

```ts
type Link = {
    identifier_target: InstanceURI;
    type: LinkType;

    auto?: true;
    metadata?: Metadata;
};
```

##### 4.6.2.1. `link.identifier_target`

The link target is an RSS3 URI, which can be an Instance URI or an Item URI. It means that the user can follow an RSS3 account, and comments on an RSS3 asset or an RSS3 note.

链接靶向是一个 RSS3 URI，可以是实体 URI 或 条目 URI。这表示用户可以关注一个 RSS 账户，且可以评论一个 RSS3 资产或 RSS3 注记。

##### 4.6.2.2. `link.type`

See [links.identifier_back](#_4-6-2-4-links-identifier-back).

见 [links.identifier_back](#_4-6-2-4-links-identifier-back)。

### 4.7. Profile （个人资料）

Profile is located in the `profile` field of an Index File, which records the basic information of the instance, including the name, avatar, profile, etc.

个人资料位于一个索引文件的 `profile` 域，其记录实体的基本信息，包括姓名、头像、个人资料等。

```ts
type Profile = {
    name?: string;
    avatars?: URI[];
    bio?: string;
    attachments?: Attachment[];

    accounts?: Accounts;

    tags?: string[];
    metadata?: Metadata;
};
```

#### 4.7.1. `profile.name`

The name of the instance, such as the user's screen name, the asset's title.

实体的姓名，例如用户的屏显名称、资产的名号。

#### 4.7.2. `profile.avatars`

Instance icons, such as the user's avatar and asset images, can be set multiple at the same time, and applications should generally choose the first to display.

实体的图标，例如用户的头像和资产图片。可同时设置为多个，应用应从中选择第一个来显示。

#### 4.7.3. `profile.bio`

Textual introduction to the instance.

实体的文字介绍。

#### 4.7.4. `profile.attachments`

When used for Item Instance, same as [item.attachments](#_4-5-3-10-item-attachments).

当用于条目实体时，用法和 [item.attachments](#_4-5-3-10-item-attachments) 一致。

When used for Account Instance, `profile` is a very flexible and diverse information. The protocol cannot predict all requirements, so only a few of the most commonly used information are defined, and it is expected to use the `attachments` field to record the profile information that is not clearly defined, such as `websites`, `banner`.

当用于账户实体时，`profile` 将是一种高度自由和多样的信息。协议无法预知所有的需求，所以仅定义了几种最常见的信息，并建议使用 `attachments` 域来记录未明确定义的个人资料信息，如 `websites`、 `banner`。

For example:

例如：

```json
{
    "attachments": [
        {
            "type": "websites",
            "content": "https://rss3.io\nhttps://diygod.me",
            "mime_type": "text/uri-list",
        },
        {
            "type": "banner",
            "content": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
            "mime_type": "image/jpeg",
        }
    ]
}
```

#### 4.7.5. `profile.accounts`

This is the other [accounts](#_4-2-account) used to record instance bindings, including accounts of cryptography-based decentralized and centralized platforms.

这是另一个用于记录实体所有物的[账户](#_4-2-account)，包括加密体系下去中心化平台和中心化平台的账户。

```ts
type Accounts = {
    identifier: AccountInstanceURI;
    signature?: string;
}[];
```

##### 4.7.5.1. `profile.accounts[i].identifier`

The URI of the account. If it is a decentralized account based on cryptography, use `profile.accounts[i].signature` to verify ownership. If it is a centralized account that cannot be signed, the user must put the address or name (Refer to [RIP-2: Registered Name Services](./RIPs/RIP-2.md)) of the Main Account into some location in the platform's account configuration to verify ownership, as specified by [RIP-1: Registered Account Platforms](./RIPs/RIP-1.md).

账户的 URI。 若其是加密领域的去中心化账户，请用 `profile.accounts[i].signature` 来核验所有权。若其是无法签名确认的中心化平台，用户必须将主账户的地址或名称（请见[RSS3 改进提案-2: 在册名称服务](./RIPs/RIP-2.md)）放于平台账户设置的某一位置以核验所有权。

#### 4.7.6. `profile.accounts[i].signature`

This is used to verify the ownership of the bound account, signed by the bound account instead of the Main Account.

该域用于核验绑定账户的所有权，将由绑定账户而非主账户签署。

```ts
profile.accounts[i].signature = sign(`[RSS3] I am adding account ${profile.accounts[i].identifier} to my RSS3 Instance ${InstanceURI}`);
```

#### 4.7.7. `profile.tags` and `profile.metadata` （`profile.tags` 和 `profile.metadata`）

For Item Instance, same as [item.tags](#_4-5-3-7-item-tags) and [item.metadata](#_4-5-3-11-item-metadata).

对于条目实体而言，用法与 [item.tags](#_4-5-3-7-item-tags) 和 [item.metadata](#_4-5-3-11-item-metadata) 相同。

### 4.8. Authentication （授权）

This set of verification mechanisms is used to verify the legitimacy of files. It covers the verification of user-submitted files by RSS3 Network, the synchronizing files between nodes in a decentralized implementation, and returned files by the RSS3 Network on the client side.

该套确权机制用于核验文件的正当性，包括 RSS3 网络中用户提交的文件、在去中心化执行中各节点间同步的文件和由 RSS3 网络返回客户端处的文件。

#### 4.8.1. SignedBase and UnsignedBase

The files are divided into signed files and unsigned files. Each file contains a field of either `SignedBase` or `UnsignedBase`, which is used to record the authentication method of the file.

文件被区分为已签文件和未签文件。每个文件含有一个名为 `SignedBase` 或 `UnsignedBase` 的域以记录该文件的授权方法。

```ts
type SignedBase = {
    signature: string;
    agents?: {
        pubkey: string;
        signature: string;
        authorization: string;
        app: string;
        date_expired: string;
    }[];
    controller?: string;
}

type UnsignedBase = {
    auto: true;
}
```

- The signed file uses the `SignedBase` type, which is used to save the data of the user's signature authentication. The client can perform signature verification. Signed files include the Index files of Account Instance and the custom item/link list files.（已签文件使用 `SignedBase` 类别，服务于储存用户的签名授权数据。客户端将可以执行签名确认。已签文件包括账户实体的索引文件和可定制条目/链接列表文件。）
- The unsigned file uses the `UnsignedBase` type to save the data generated by the RSS3 Network. The client needs to verify it according to the relevant signed file or `metadata.proof` field. Unsigned files include aggregated item/link list files, and reverse relation list files. （未签文件使用 `UnsignedBase` 类别来储存由 RSS 网络生成的数据。客户端需要根据相关的已签文件或 `metadata.proof` 域来核验。未签文件包括聚合条目/链接列表文件，反向联系列表文件。）

#### 4.8.2. `signature`

This is located in the root path of a signed file, signed by Instance's private key. The signature message is the file's JSON string sorted by key alphabetically. The signature algorithm may vary depending on the platform. Which algorithm to use is defined in [RIP-1: Registered Account Platforms](./RIPs/RIP-1.md).

其位于一个已签文件的根路径，由实体的私钥签署。文件的 JSON 字段经由该值的字母表顺序排序后即为签名消息。签名算法可依据平台的不同而不同。使用哪种算法由[RSS3 改进提案-1: 在册账户平台](./RIPs/RIP-1.md)定义。

When verifying the signature and calculating the signed message, note that the existing `signature` field must be removed first.

请注意，在核验签名和计算签名消息时，已存在的 `signature` 域需事先抹除。

```ts
signatrue = sign(`[RSS3] I am confirming the results of changes to my file ${identifier}: ${SortedStringify(file)}`);
```

For example, a file like:

例如一个像这样的文件：

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum",
    "signatrue": "This should not be included",

    "items": {
        "notes": 1,
        "assets": 2
    }
}
```

Its signature is: `[RSS3] I am confirming the results of changes to my file rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum: {"items":{"assets":2,"notes":1},"version":"v0.4.0"}`

其签名是： `[RSS3] I am confirming the results of changes to my file rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum: {"items":{"assets":2,"notes":1},"version":"v0.4.0"}`

#### 4.8.3. `agents`

::: danger
This is a feature that may reduce security significantly. The protocol will remove it or make significant changes in future versions depending on actual usage.
:::

::: 危险
该特性可以显著降低安全性。协议将剔除该特性，或依据实际使用在未来版本中做出重大变更。
:::

It is located in the root path of a signed file. This is a function similar to remember me in Web2. You can use the signature of the Main Account to authorize a randomly local-generated proxy signature account. When modifying the file, use the proxy account for signature authorization to reduce the number of signatures of the Main Account and the cost of use.

其位于一个已签文件的根路径。其功能类似于 Web2 中的记住我。你可以使用主账户的签名来授权一个随机由本地生成的代理签名账户。当改动文件时，可用代理账户进行签名授权来降低用主账户签名的次数并降低使用的开销。

This also means that if the private key of the proxy account is leaked or the application chooses to do evil, the file will lose its security completely. End users will have to reauthorize this feature with full trust in the application.

这同时意味着若代理账户的私钥暴露或应用方选择作恶，那该文件将彻底失去安全性。终端用户将不得不在应用中以完全信任重新授权该功用。

The encryption algorithm uses Ed25519.

加密算法采用 Ed25519。

##### 4.8.3.1. `agents[i].pubkey`

The base64 of the public key of the proxy account, generated by the client.

代理账户的公钥的 base64 值，由客户都生成。

##### 4.8.3.2. `agents[i].signature`

The base64 of the private key of the proxy account. The signed message is the same as the `signature`. Similarly, existing `agents[i].signature` of the current agent should be removed during the calculation.

代理账户的私钥的 base64 值。签名消息与 `signature` 一致。类似的，在计算时，当前代理人原已存在的 `agents[i].signature` 应被抹除。

##### 4.8.3.3. `agents[i].authorization`

While it is technically sufficient to use the root `signature` to verify the authenticity of the agent, adding `agents[i].authorization` can alert the user to the risk of agents by having the user sign this alert message.

当技术上足够使用根 `signature` 来核验代理人的真实性时，增加 `agents[i].authorization` 能通过让用户对该警示消息进行签名来提醒用户关于代理人的风险。

The authorized signature of the Main Account to the proxy account.

主账户向代理账户的授权签名。

```ts
agents.signatrue = sign(`[RSS3] I am well aware that this APP (name: ${app}) can use the following agent instead of me (${InstanceURI}) to modify my files and I would like to authorize this agent (${pubkey})`);
```

##### 4.8.3.4. `agents[i].app`

The application name used to distinguish different proxy accounts.

用于区分不同代理账户的应用名。

##### 4.8.3.5. `agents[i].date_expired`

The expiration time of the proxy account, the RSS3 Network should limit the maximum value. After expiration, the proxy account should be deleted.

代理账户的过期时间， RSS3 网络应设置其最大限值。过期后，代理账户应被删除。

#### 4.8.4. `controller`

Reserved field, used to define the control of the file, not used for now.

保留域，用于定义文件的控制，暂未启用。

The current plan is to use a contract to control the controller of the file for scenarios, such as forums that require multiple people to modify the same file together.

当前计划是使用一个合约来在不同场景下控制文件的控制器，例如在论坛中需要多人去一起改动同一个文件。

## 5. Validation （验证）

### 5.1. TypeScript

```ts
// Instance
type AccountInstance = string;
type ItemInstance = string;

type Instance = AccountInstance | ItemInstance;

// URI
type InstanceURI = string;

type CustomItemListURI = string;
type AggregatedItemListURI = string;

type CustomLinkListURI = string;
type AggregatedLinkListURI = string;
type BacklinkListURI = string;

type URI = string;

// Common attributes for each files
interface Base {
    version: 'v0.4.0';
    identifier: InstanceURI | CustomItemListURI | AggregatedItemListURI | CustomLinkListURI | AggregatedLinkListURI | BacklinkListURI;
    date_created: string;
    date_updated: string;
}

interface SignedBase extends Base {
    signature: string;
    agents?: {
        pubkey: string;
        signature: string;
        authorization: string;
        app: string;
        date_expired: string;
    }[];
    controller?: string;
}

interface UnsignedBase extends Base {
    auto: true;
}

// Base types
interface Attachment {
    type?: string;
    content?: string;
    address?: URI;
    mime_type: string;
    size_in_bytes?: number;
}

interface Metadata {
    network?: NetworkName;
    proof: string;

    [key: string]: any;
}

interface Filters {
    blocklist?: string[];
    allowlist?: string[];
}

interface LinksSet {
    identifiers?: {
        type: LinkType;
        identifier_custom: CustomLinkListURI;
        identifier: AggregatedLinkListURI;
    }[];
    identifier_back: BacklinkListURI;
}

// RSS3 index files, main entrance for a instance
interface Index extends SignedBase, UnsignedBase {
    identifier: InstanceURI;

    profile?: {
        name?: string;
        avatars?: URI[];
        bio?: string;
        attachments?: Attachment[];

        accounts?: {
            identifier: InstanceURI;
            signature?: string;
        }[];

        tags?: string[];
        metadata?: Metadata;
    };

    links: LinksSet;

    items: {
        notes: {
            identifier_custom?: CustomItemListURI;
            identifier: AggregatedItemListURI;
            filters?: Filters;
        };
        assets: {
            identifier_custom?: CustomItemListURI;
            identifier: AggregatedItemListURI;
            filters?: Filters;
        };
    };
}

// items
type Item = {
    identifier: ItemInstanceURI;
    date_created: string;
    date_updated: string;

    auto?: true;
    related_urls?: string[];

    links: LinksSet;

    tags?: string[];
    authors: Account[];
    title?: string;
    summary?: string;
    attachments?: Attachment[];

    metadata?: Metadata;
};

type Link = {
    identifier_target: InstanceURI;
    type: LinkType;

    auto?: true;
    metadata?: Metadata;
};

// RSS3 list files
type ListBase<URIType, ElementType> = {
    identifier: URIType;
    identifier_next?: URIType;

    total: number;
    list?: ElementType[];
}

type CustomItemList = SignedBase & ListBase<CustomItemListURI, Item>;
type AggregatedItemList = UnsignedBase & ListBase<AggregatedItemListURI, Item>;

type CustomLinkList = (SignedBase | UnsignedBase) & ListBase<CustomLinkListURI, Link>;
type AggregatedLinkList = UnsignedBase & ListBase<AggregatedLinkListURI, Link>;
type BacklinkList = UnsignedBase & ListBase<BacklinkListURI, Link>;
```

### 5.2. JSON Schema

TODO

## 6. Use Cases （使用案例）

### 6.1. Index File Demo （索引文件样例）

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x85d66b17df7343364c6b89ede6ff15279505abfdfa7b8c70590d53a3a10db97a504b8a2536a7dcc12527af42f28f643a258d48f395b8fa5917336f06d8972be41c",
    "agents": [
        {
            "pubkey": "rrqJ2xn7oUd4wGW8VbsZk9XeacYMap4/jprIA5b35ns=",
            "signature": "PObUwUA+BEStJZJoY4xBsOkQujsRAZ4yULZIu0orDHCID2ezI5/eD8EskIK+RFNvSCp9tKTSYqurEFa2egW6Dg==",
            "authorization": "",
            "app": "Revery",
            "date_expired": "2023-02-10T22:50:53.132Z"
        }
    ],

    "profile": {
        "name": "DIYgod",
        "avatars": [
            "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t"
        ],
        "bio": "Cofounder of RSS3.",
        "attachments": [
            {
                "type": "websites",
                "content": "https://rss3.io\nhttps://diygod.me",
                "mime_type": "text/uri-list",
            },
            {
                "type": "banner",
                "content": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                "mime_type": "image/jpeg",
            }
        ],

        "accounts": [
            {
                "identifier": "rss3://account:0x8768515270aA67C624d3EA3B98CA464672C50183@ethereum",
                "signature": "0x4828da56a162b9504dca6009864a90ed0ca3e56256d8458af451874ad7dd9cb26be4f399a56a8b69a881297ba6b6434a7f2f4a4f3557890d1efa8490769187be1b"
            },
            {
                "identifier": "rss3://account:DIYgod@twitter"
            }
        ]
    },

    "links": {
        "identifiers": [
            {
                "type": "following",
                "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1",
                "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following"
            },
        ],
        "identifier_back": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/backlink"
    },

    "items": {
        "notes": {
            "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0",
            "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note",
            "filters": {
                "blocklist": [
                    "Twitter"
                ]
            }
        },
        "assets": {
            "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0",
            "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset",
            "filters": {
                "allowlist": [
                    "Polygon"
                ]
            }
        }
    }
}
```

### 6.2. Link List File Demo （链接列表样例）

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1",
    "identifier_next": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 8,
    "list": [
        {
            "identifier_target": "rss3://account:0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045@ethereum",
            "type": "following"
        },
        {
            "identifier_target": "rss3://asset:1B599C2B-5153-5DFC-8909-25AE1D51E801@rss3",
            "type": "following"
        },
        {
            "identifier_target": "rss3://note:1483972580616949762@twitter",
            "type": "following"
        },
        {
            "identifier_target": "rss3://asset:0xacbe98efe2d4d103e221e04c76d7c55db15c8e89-5@ethereum",
            "type": "following"
        }
    ]
}
```

### 6.3. Asset List File Demo （资产列表文件样例）

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 1,
    "list": [
        {
            "identifier": "rss3://asset:D52DCF9F-7FF0-400A-9562-66C87DB3A866@rss3",
            "date_created": "2021-08-17T14:36:00.676Z",
            "date_updated": "2022-02-10T22:50:53.132Z",

            "links": {
                "identifier_back": "rss3://asset:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/backlink"
            },
        
            "tags": [
                "Garage Kit"
            ],
            "authors": [
                "0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum"
            ],
            "summary": "My Garage Kit - 2233",
            "attachments": [
                {
                    "address": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                    "mime_type": "image/jpg",
                    "size_in_bytes": 1024
                }
            ]
        }
    ]
}
```

### 6.4. Note List File Demo （注记列表文件样例）

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 1,
    "list": [
        {
            "identifier": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3",
            "date_created": "2021-08-17T14:36:00.676Z",
            "date_updated": "2022-02-10T22:50:53.132Z",

            "links": {
                "identifiers": [
                    {
                        "type": "comment",
                        "identifier_custom": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/link/comment/0",
                        "identifier": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/link/comment"
                    },
                ],
                "identifier_back": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/backlink"
            },

            "authors": [
                "0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum",
                "0x09D9719d01f48304993b35c5b5c813DdCD622362@ethereum"
            ],
            "title": "RSS3 is born",
            "summary": "RSS3 is a next-generation feed standard that aims to support efficient and decentralized information distribution.",
            "attachments": [
                {
                    "content": "# I include a markdown",
                    "mime_type": "text/markdown"
                }, {
                    "address": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                    "mime_type": "image/jpg",
                    "size_in_bytes": 1024
                }
            ]
        }
    ]
}
```
